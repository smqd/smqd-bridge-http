
smqd {

  node_name = "smqd-01"
  actor_system_name = "test"

  plugin {
    dir = "target/scala-2.12"
    manifest = "src/test/conf/smqd-plugins-manifest-test.conf"
  }

  bridge {
    drivers = [
      {
        name = "http_br"
        plugin = com.thing2x.bridge-http
        config {
          parallelism = 0
          queue = 20
          overflow-strategy = drop-buffer  # drop-head drop-tail drop-buffer drop-new backpressure fail
        }
      }
    ]

    bridges = [
      {
        topic = "sensor/+/temperature"
        driver = http_br
        method = POST
        path = "http://127.0.0.1:8080/api/v1/blackhole"
      },
      {
        topic = "sensor/+/humidity"
        driver = http_br
        method = POST
        content-type = text/plain
        prefix = "http://127.0.0.1:8080/api/v1/blackhole/"
        suffix = "?from=smqd01"
      }
    ]
  }

  services = [core-fault, core-protocol, core-mqtt, core-api]

  core-api {
    config {
      routes {
        test {
          prefix = api/v1
          class = com.thing2x.smqd.rest.TestController
        }
      }
    }
  }
}
